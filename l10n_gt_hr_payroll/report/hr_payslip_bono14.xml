<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="formato_recibo_bono14">
        <t t-call="web.basic_layout">
            <div class="page">
                <link rel="stylesheet" href="/l10n_gt_hr_payroll/static/src/css/payroll_report.css" />
                <t t-set="periodo" t-value="o._obtener_periodo_bono14()" />
                <t t-set="dias_laborados" t-value="periodo['dias_laborados']" />
                <t t-set="descuentos" t-value="0" />
                <t t-set="bono14" t-value="0" />
                <t t-set="bruto_bono14" />
                <t t-foreach="o.line_ids.filtered(lambda line: line.appears_on_payslip)" t-as="line">
                    <t t-if="(line.code == 'GROSS')">
                        <t t-set="bruto_bono14" t-value="line.total" />
                    </t>
                    <t t-if="(line.code == 'BONO14')">
                        <t t-set="bono14" t-value="line.total" />
                    </t>
                    <t t-if="(line.category_id.code == 'DED')">
                        <t t-set="descuentos" t-value="descuentos + line.total" />
                    </t>
                </t>
                <!-- <t t-foreach="o.worked_days_line_ids" t-as="worked_days">
                        <t t-if="worked_days.code != 'OUT'">
                            <t t-set="dias_laborados" t-value="dias_laborados + worked_days.number_of_days"/>
                        </t>
                    </t> -->
                <table class="table w-100">
                    <tr class="border-recibo">
                        <td colspan="2" class="py-3 px-2" style="font-size:20px;font-weight: 900 !important;">BOLETA PAGO BONO 14</td>
                        <td colspan="2" class="text-right" style="font-size:20px;font-weight: 900 !important;">
                            AÑO
                            <t t-if="o.contract_id.date_end and o.date_to &gt; o.contract_id.date_end">
                                <t t-esc="o.contract_id.date_end.year" />
                            </t>
                            <t t-else="">
                                <t t-esc="o.date_to.year" />
                            </t>
                        </td>
                    </tr>
                    <tr class="bg-white">
                        <td colspan="2" class="border-recibo text-primary">
                            Nombre:
                            <span t-field="o.employee_id" />
                        </td>
                        <td colspan="2" class="border-recibo text-primary">
                            Días trabajados:
                            <t t-esc="dias_laborados" />
                        </td>
                    </tr>
                    <tr class="bg-white">
                        <td colspan="2" class="border-recibo text-primary">
                            Período:
                            <!-- <t t-if="o.date_from &lt; o.contract_id.date_start">
                                    <span t-field="o.contract_id.date_start"/>
                                </t>
                                <t t-else="">
                                    <span t-field="o.date_from"/>
                                </t>
                                 - 
                                <t t-if="o.contract_id.date_end and o.date_to &gt; o.contract_id.date_end">
                                    <span t-field="o.contract_id.date_end"/>
                                </t>
                                <t t-else="">
                                    <span t-field="o.date_to"/>
                                </t> -->
                            <t t-esc="periodo['periodo_inicio']" t-options="{'widget': 'date'}" />
                            -
                            <t t-esc="periodo['periodo_fin']" t-options="{'widget': 'date'}" />

                        </td>
                        <td colspan="2" class="border-recibo text-primary">
                            Salario Base:
                            <span t-esc="o.contract_id.wage" t-options="{'widget': 'monetary', 'display_currency': o.company_id.currency_id}" />
                        </td>
                    </tr>
                    <tr class=" border-recibo py-3 px-2">
                        <td colspan="2">BONO 14</td>
                        <td colspan="2" class="text-right">LIQUIDO A RECIBIR</td>
                    </tr>
                    <tr class="bg-gris">
                        <td colspan="2" class="border-i-recibo">
                            <t t-esc="bono14" t-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}' />
                        </td>
                        <td colspan="2" class="border-d-recibo">
                            DESCUENTO:
                            <t t-if="descuentos == 0">
                                    N/A
                                </t>
                            <t t-if="descuentos != 0">
                                <t t-esc="descuentos" t-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}' />
                            </t>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4" class="border-i-recibo border-d-recibo">&#160;</td>
                    </tr>
                    <tr class="bg-gris">
                        <td colspan="2" class="border-i-recibo">&#160;</td>
                        <td colspan="2" class="border-d-recibo">
                            TOTAL RECIBIDO:
                            <t t-esc="bruto_bono14" t-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}' />
                        </td>
                    </tr>
                    <tr class="bg-white">
                        <td class="border-i-recibo border-arriba-recibo"></td>
                        <td class="border-arriba-recibo"></td>
                        <td class="border-arriba-recibo"></td>
                        <td class="border-d-recibo border-arriba-recibo"></td>
                    </tr>
                    <tr class="bg-white">
                        <td class="border-i-recibo text-primary">
                                FIRMA RECIBÍ CONFORME:
                            </td>
                        <td class="border-0"></td>
                        <td class="border-0"></td>
                        <td class="border-d-recibo"></td>
                    </tr>
                    <tr class="bg-white">
                        <td class="border-i-recibo border-abajo-recibo"></td>
                        <td class="border-abajo-recibo"></td>
                        <td class="border-abajo-recibo"></td>
                        <td class="border-d-recibo border-abajo-recibo"></td>
                    </tr>

                </table>
            </div>
        </t>
    </template>

    <template id="reporte_recibo_bono14">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-set="o" t-value="o.with_context(lang=o.employee_id.sudo().address_home_id.lang or o.env.lang)" />
                <t t-call="l10n_gt_hr_payroll.formato_recibo_bono14" t-lang="o.env.lang" />
            </t>
        </t>
    </template>
</odoo>
    