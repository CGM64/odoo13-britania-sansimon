<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <template id="statement_report_document">
        <t t-call="web.external_layout">
            <t t-set="o" t-value="doc.with_context({'lang': 'en_US'})" />
            <div class="page">

                <style>
                    .div-bg {
                        background-color:#3D3D3D;
                        border-radius:20px;
                    }
                    .border-secondary{
                        border: 2px solid  #3D3D3D !important;
                        border-radius:20px !important;
                    }
                    .no-conciliado{
                        color: red;
                    }

                </style>

                <div class="encabezado" t-foreach="o.conciliacion_bancaria()" t-as="conciliacion">
                    <div class="row">
                        <div class="col-12 mt-2 text-center">
                            <strong>CONCILIACION BANCARIA</strong>
                        </div>
                    </div>

                    <div class="mt-3">

                        <div class="row">
                            <div class="col-2">
                                <strong>BANCO:</strong>
                            </div>
                            <div class="col-10">
                                <p t-esc="conciliacion['banco']"/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-2">
                                <strong>NO. CUENTA:</strong>
                            </div>
                            <div class="col-4">
                                <p t-esc="conciliacion['cuenta']"/>
                            </div>
                            <div class="col-2">
                                <strong>DIARIO:</strong>
                            </div>
                            <div class="col-4">
                                <p t-esc="conciliacion['diario']"/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-2">
                                <strong>FECHA:</strong>
                            </div>
                            <div class="col-10">
                                <p t-esc="conciliacion['fecha']"/>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3 div-bg p-1 mb-1 text-white">
                        <div class="col-2 text-center ">FECHA</div>
                        <div class="col-6 text-center ">DESCRIPCION</div>
                        <div class="col-1 text-center">REF</div>
                        <div class="col-3 text-center">VALOR</div>
                    </div>

                    <div class="detalle" t-foreach="o.lista_documentos_bancarios()" t-as="doc">

                        <div class="row mt-3 mb-1">
                            <div class="col-12 text-left ">
                                <strong t-esc="doc[1]"/>
                            </div>
                        </div>

                        <div class="row" t-foreach="conciliacion[doc[0]]" t-as="documento">


                            <t t-if="documento['line_fecha']=='N'">
                                <div class="col-2 text-left no-conciliado ">
                                    <p t-esc="documento['line_fecha']"/>
                                </div>
                                <div class="col-7 text-left no-conciliado">
                                    <p t-esc="documento['line_name']"/>
                                </div>

                                <div class="col-3 text-right no-conciliado">
                                    <p t-esc="'{0:,.2f}'.format(documento['line_amount'])"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="col-2 text-left ">
                                    <p t-esc="documento['line_fecha']"/>
                                </div>
                                <div class="col-7 text-left">
                                    <p t-esc="documento['line_name']"/>
                                </div>

                                <div class="col-3 text-right">
                                    <p t-esc="'{0:,.2f}'.format(documento['line_amount'])"/>
                                </div>
                            </t>


                        </div>

                        <div class="row">
                            <div class="col-9 text-right ">
                                <strong t-esc="'TOTAL '+ str(doc[1])"/>
                            </div>

                            <div class="col-3 text-right border border-secondary">
                                <strong t-esc="'{0:,.2f}'.format(conciliacion['SUM_'+doc[0]])"/>
                            </div>

                        </div>

                    </div>


                    <!-- RESUMEN DE LA CONCILIACION -->
                    <div class="row mt-4">
                        <div class="col-4 text-left ">
                            <strong t-esc="'SALDO MES ANTERIOR'"/>
                        </div>
                        <div class="col-3 text-right ">
                            <strong t-esc="'{0:,.2f}'.format(conciliacion['saldo_inicial'])"/>
                        </div>
                        <div class="col-5 text-right "></div>
                    </div>

                    <div class="row">
                        <div class="col-4 text-left ">
                            <p>(-) CHEQUES EN CIRCULACION</p>
                        </div>
                        <div class="col-3 text-right ">
                            <p t-esc="'{0:,.2f}'.format(conciliacion['SUM_CHC'])"/>
                        </div>
                        <div class="col-5 text-right "></div>
                    </div>
                    <div class="row">
                        <div class="col-4 text-left ">
                            <p>(-) CHEQUES</p>
                        </div>
                        <div class="col-3 text-right ">
                            <p t-esc="'{0:,.2f}'.format(conciliacion['SUM_CH'])"/>
                        </div>
                        <div class="col-5 text-right "></div>
                    </div>

                    <div class="row">
                        <div class="col-4 text-left ">
                            <p>(+) DEPOSITOS</p>
                        </div>
                        <div class="col-3 text-right ">
                            <p t-esc="'{0:,.2f}'.format(conciliacion['SUM_DP'])"/>
                        </div>
                        <div class="col-5 text-right "></div>
                    </div>

                    <div class="row">
                        <div class="col-4 text-left ">
                            <p>(+) OTROS CREDITOS</p>
                        </div>
                        <div class="col-3 text-right ">
                            <p t-esc="'{0:,.2f}'.format(conciliacion['SUM_NC'])"/>
                        </div>
                        <div class="col-5 text-right "></div>
                    </div>

                    <div class="row bt">
                        <div class="col-4 text-left ">
                            <p>(-) OTROS DEBITOS</p>
                        </div>
                        <div class="col-3 text-right ">
                            <p t-esc="'{0:,.2f}'.format(conciliacion['SUM_ND'])"/>
                        </div>
                        <div class="col-5 text-right "></div>
                    </div>

                    <div class="row">
                        <div class="col-4 text-left ">
                            <strong>SALDO CONTABLE</strong>
                        </div>
                        <div class="col-3 text-right border-top">
                            <strong t-esc="'{0:,.2f}'.format(conciliacion['SALDO_CONTABLE'])"/>
                        </div>
                        <div class="col-5 text-right "></div>
                    </div>

                    <div class="row bb">
                        <div class="col-4 text-left ">
                            <strong>SALDO SEGUN SISTEMA</strong>
                        </div>
                        <div class="col-3 text-right border-bottom">

                        </div>
                        <div class="col-5 text-right "></div>
                    </div>

                    <div class="row">
                        <div class="col-4 text-left ">
                            <strong>DIFERENCIA CON BANCOS</strong>
                        </div>
                        <div class="col-3 text-right ">

                        </div>
                        <div class="col-5 text-right "></div>
                    </div>

                </div>
            </div>
        </t>
    </template>





    <!--TEMPLATE [BANK STATEMENT REPORT]-->
    <template id="statement_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="conciliacion_bancaria.statement_report_document"/>
            </t>
        </t>
    </template>

    <report id="action_statement_report" model="account.bank.statement" string="Conciliacion" report_type="qweb-pdf" name="conciliacion_bancaria.statement_report" file="conciliacion_bancaria.statement_report" paperformat="base.paperformat_us" />

    <!--FORM BANK STATEMENT-->
    <record id="view_account_bank_statement_form_inherit" model="ir.ui.view">
        <field name="name">account.bank.statement.report.form</field>
        <field name="model">account.bank.statement</field>
        <field name="inherit_id" ref="account.view_bank_statement_form"/>
        <field name="arch" type="xml">
            <button name="check_confirm_bank" position="after">
                <button name="print_bank_statement" string="Imprimir" type="object" help="Print in Pdf"/>
            </button>
        </field>

    </record>

</odoo>
